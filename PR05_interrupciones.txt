;AUTORES:Alex Tomé Aguiar e Irene Ruiz Juez
;FECHA:24/04/2019
;DESCRIPCION:Práctica 5 hecha con interrupciones


	.ORG 1000H	
	MVI A,8		;ACTIVA EL BIT MSE
	SIM
	EI		;HABILITA LAS INTERRUPCIONES		;FIJA LA MASCARA
BUCLE:
	RIM		;CARGA LA MASCARA
	ANI 16		;HACEMOS UN AND CON 16
	CPI 16		;COMPARAMOS CON 16
	JNZ BUCLE	;SALTA A BUCLE 
	CALL 044EH	;LLAMAMOS A LA SUBRUTINA
	LXI H,1300H
	SUI 30H
	MOV M,A		;MOVEMOS EL CONTENIDO DE REG.A AL REG.B
	ADI 30H
	CALL 04D5H	;LLAMAMOS A LA SUBRUTINA 04D5H
	MOV A,M		;MOVEMOS LOS DATOS DEL REG.B AL REG.A

	LXI H,1301H
	MVI M,10
	MVI A,1
	STA 1302H
	LDA 1300H
	STA 1200H
BUCL:	
	LXI H,1300H
	MOV B,M
	LXI H,1302H
	MOV C,M
	CALL MULT
	MOV D,A
	MOV A,E
	CPI FFH
	JZ FIN3
	MVI H,12H
	LDA 1302H
	MOV L,A
	MOV M,D
	LDA 1302H
	LXI H,1301H
	CMP M
	JZ FIN3
	INR A
	STA 1302H
	JMP BUCL
FIN3: 
	HLT



;RUTINA MULTIPLICACION
;RECUROS UTILIZADOS: D = RESULTADO , B = MULTIPLICANDO , C = MULTIPLICADOR , E = DESBORDAMIENTO


MULT:	
	MVI D,0
	MVI E,0
	MOV A,B
	CPI 0
	JZ FIN
	MOV A,C
	CPI 0
	JZ FIN
MUL1:	
	RAR
	MOV C,A
	JNC MUL2
	CMC
	MOV A,D
	ADD B
	MOV D,A
	JNC MUL2
	MVI E,FFH
	JMP FIN2
MUL2:	
	MOV A,C
	CPI 0
	JZ FIN
	MOV A,B
	RLC
	MOV B,A
	MOV A,C
	JMP MUL1
FIN:	
	MOV A,D
FIN2:	
	RET

;INTERRUPCION
	.ORG 002CH
	RET

;COGER DATO LEIDO DEL TECLADO Y CARCGARLO EN EL ACUMULADOR
	.ORG 044Eh
	IN 0
	EI
	RET

;MOSTRAR POR PANTALLA DATO DEL ACUMULADOR
	.ORG 04D5H
	STA E1A0H
	RET